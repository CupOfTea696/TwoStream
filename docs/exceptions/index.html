<!DOCTYPE html><html lang="en-us" id="twostream"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>TwoStream by CupOfTea696</title><base href="http://twostream.cupoftea.io"><link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/app.css?cb=79a4a10e5dcc99daa5f83d42d21bfd62"></head><body> <nav class="nav"> <section class="nav/left"> <a href="" class="nav/item">TwoStream</a> </section> <section class="nav/right"> <a href="docs" class="nav/item">Documentation</a> <a href="docs/api" class="nav/item">API</a> </section> </nav><section class="main-content" id="docs-exceptions"><div class="body clearfix"><ol class="breadcrumb"><li class="breadcrumb/item"> <a href="">Home</a></li><li class="breadcrumb/item"> <a href="docs">Documentation</a></li><li class="breadcrumb/item --active">Error Handling</li></ol> <aside class="sidebar"> <nav><ul class="sidebar/nav"><li class="sidebar/nav/category">Getting Started</li><li class="sidebar/nav/item"> <a href="docs/installation">Installation</a></li><li class="sidebar/nav/item"> <a href="docs/configuration">Configuration</a></li><li class="sidebar/nav/item"> <a href="docs/server">Running TwoStream</a></li><li class="sidebar/nav/category">The Basics</li><li class="sidebar/nav/item"> <a href="docs/routing">Routing</a></li><li class="sidebar/nav/item"> <a href="docs/controllers">Controllers</a></li><li class="sidebar/nav/item"> <a href="docs/requests">Requests</a></li><li class="sidebar/nav/item"> <a href="docs/responses">Responses</a></li><li class="sidebar/nav/category">Services</li><li class="sidebar/nav/item --active">Error Handling</li><li class="sidebar/nav/item"> <a href="docs/events">Events</a></li><li class="sidebar/nav/item"> <a href="docs/twostream">TwoStream</a></li><li class="sidebar/nav/item"> <a href="docs/ws-session">WsSession</a></li></ul> </nav> </aside><main id="content" class="page"><h1 id="exceptions">Exceptions</h1><ul class="toc"><li class="toc/item"> <a data-scrollto="the-error-handler">The Error Handler</a><ul class="toc/level toc"><li class="toc/item"><a data-scrollto="the-report-method">The Report Method</a></li><li class="toc/item"><a data-scrollto="the-render-method">The Render Method</a></li></ul></li></ul><p>To try and keep the WebSocket server running as smoothly as possible, TwoStream catches all Exceptions, syntax errors and recoverable fatal errors. By default, any Exception or error is logged, and sent to the front-end through the WebSocket connection.</p><h2 id="the-error-handler">The Error Handler</h2><p>Once you have installed TwoStream, an Error Handler has been published to deal with any Exceptions. You can find it in <code>app/Exceptons/WsHandler.php</code>. It contains two methods, <code>report</code> and <code>render</code>. They are inherently the same methods as the <a href="http://laravel.com/docs/5.1/errors#the-exception-handler">Exception Handler</a> provided to you by Laravel.</p><h3 id="the-report-method">The Report Method</h3><p>The <code>report</code> method is used to log Exceptions or send them to an external service. You can access the LoggerInterface using <code>$this-&gt;log</code>. You can also ignore Exceptions by type useing the <code>$dontReport</code> property, as explained in the <a href="http://laravel.com/docs/5.1/errors#the-exception-handler">Laravel Documentation</a>.</p><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">public</span> <span class="k">function</span> <span class="nf">report</span><span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span> <span class="nx">instanceof</span> <span class="nx">SomeExceptiob</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">report</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><h3 id="the-render-method">The Render Method</h3><p>The render method is very much alike, apart from the fact that you can return an Array or Object that will be sent as JSON through the WebSocket Connection. There is no need to specify a recipient in this case, for the response will always be sent to the <a href="http://twostream.cupoftea.io/docs/responses/#pre-defined-recipient-lists">requestee</a>.</p><p>Additionally, you can also sent output back to the Console, which the TwoStream Error Handler already does by default. To send output to the console, use the <code>line</code>, <code>info</code>, <code>comment</code>, <code>question</code> and <code>error</code> methods available on the Error Handler. Each of these methods will use the appropriate ANSI colors for their purpose.</p><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s2">"Error: </span><span class="si">{</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">'msg'</span> <span class="o">=&gt;</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span>
            <span class="s1">'domain'</span> <span class="o">=&gt;</span> <span class="s1">'php.'</span> <span class="o">.</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'\_'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="nx">snake_case</span><span class="p">(</span><span class="nb">get_class</span><span class="p">(</span><span class="nv">$e</span><span class="p">)))</span>
        <span class="p">]</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div><p><u><strong>Note:</strong> It is highly recommended that you don't call the parent render method in production, for it sends the entire error including its stack trace back to the client.</u></p> </main></div> <footer class="site-footer"> <span class="site-footer-owner"> <a href="https://github.com/CupOfTea696/TwoStream/">TwoStream</a> is maintained by <a href="https://github.com/CupOfTea696">CupOfTea696</a>. </span> </footer> </section> <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script><script src="/assets/js/app.js?cb=d735cbd9e60a21104256df7ee8382009"></script></body></html>